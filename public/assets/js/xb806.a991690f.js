(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["xb806"],{"823f":function(t,s,e){},"8bf8":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"viewContainer"},[e("v-container",{staticClass:"pa-0"},[e("v-container",{staticClass:"inner-container"},[e("v-card",{staticClass:"mt-md-12 mt-0 content-tabs-wrapper",attrs:{tile:"",elevation:"0"}},[e("v-tabs",{staticClass:"px-5 content-tabs",attrs:{color:t.$store.state.app.dark?"white":"black","icons-and-text":"",height:"100","slider-size":"4","show-arrows":""}},[e("v-tabs-slider"),e("v-tab",{staticClass:"no-caps",attrs:{to:{name:"settings.profile"},ripple:!1}},[t._v(" "+t._s(t.$t("profile"))+" "),e("v-icon",{attrs:{size:"24"}},[t._v("mdi-account-circle")])],1),e("v-tab",{staticClass:"no-caps",attrs:{to:{name:"settings.business"},ripple:!1}},[t._v(" "+t._s(t.$t("business"))+" "),e("v-icon",{attrs:{size:"24"}},[t._v("mdi-briefcase")])],1),e("v-tab",{staticClass:"no-caps",attrs:{to:{name:"settings.business.subscription"},ripple:!1}},[t._v(" Billing "),e("v-icon",{attrs:{size:"24"}},[t._v("mdi-domain")])],1)],1),e("v-divider")],1),e("v-tabs-items",{staticStyle:{"background-color":"transparent"},model:{value:t.tab,callback:function(s){t.tab=s},expression:"tab"}},[e("v-tab-item",{attrs:{transition:!1,"reverse-transition":!1,value:"tab-0"}},[e("v-container",{staticClass:"pa-0"},[e("v-row",{attrs:{"no-gutters":""}},[e("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[e("v-card",{staticClass:"pa-5 mb-0",attrs:{flat:"",tile:""}},[e("v-card-text",[e("v-card",{attrs:{outlined:""}},[e("v-card-title",[t._v("Monthly Billing Report")]),e("v-select",{staticClass:"ma-5",attrs:{label:"Select a year",items:t.billings.transactionYears,"item-text":"0","item-value":"0"},model:{value:t.billings.transactionYear,callback:function(s){t.$set(t.billings,"transactionYear",s)},expression:"billings.transactionYear"}}),e("v-select",{staticClass:"ma-5",attrs:{label:"Select a month",items:t.getMonths,"item-text":"text","item-value":"value"},model:{value:t.billings.transactionMonth,callback:function(s){t.$set(t.billings,"transactionMonth",s)},expression:"billings.transactionMonth"}}),t.billings.loaded&&200==t.billings.status_code&&""!=t.transactionMonth?e("div",{staticClass:"ma-5"},[e("v-input",{attrs:{"prepend-icon":"mdi-trending-up",color:"black",messages:["Points Issuance Sessions: "+(this.billings.transaction_details.earnings.count||0)]}},[t._v("Total Points Issued: "+t._s(this.billings.transaction_details.earnings.amount))]),e("v-input",{attrs:{"prepend-icon":"mdi-trending-down",color:"black",messages:["Points Redemption Sessions: "+(this.billings.transaction_details.spendings.count||0)]}},[t._v("Total Points Redeemed: "+t._s(this.billings.transaction_details.spendings.amount))]),e("v-input",{attrs:{"prepend-icon":"mdi-clock",color:"black",messages:["Due Date (Net 7)"]}},[t._v(t._s(this.billings.due_details.date))]),e("v-input",{attrs:{"prepend-icon":"mdi-cash",color:"black",messages:["Amount Due"]}},[t._v(t._s(this.billings.due_details.amount))]),e("v-input",{attrs:{"prepend-icon":"mdi-file-document",color:"black",messages:["Invoice NO"]}},[t._v(t._s(this.billings.invoice_no))]),e("v-input",{attrs:{messages:["Payment Status"]}},[e("v-icon",{attrs:{slot:"prepend",color:1==t.billings.due_details.status?"green":"red"},slot:"prepend"},[t._v(t._s(1==this.billings.due_details.status?"mdi-check":"mdi-close"))]),t._v(" "+t._s(1==this.billings.due_details.status?"Paid":"Not Paid")+" ")],1),e("div"),e("v-list",[e("h4",{staticClass:"ma-3"},[t._v("Payment Options")]),e("v-list-item",{attrs:{"three-line":""}},[e("v-list-item-content",[e("v-list-item-title",[t._v("Pay by Check")]),e("p",[t._v("Make check payable to: Piggy Bank Loyalty")]),e("p",[t._v("Mail check to: Kingstown, St Vincent & the Grenadines")]),e("p",[t._v("Alternatively, we can arrange pickup.")])],1)],1),e("v-list-item",{attrs:{"two-line":""}},[e("v-list-item-content",[e("v-list-item-title",[t._v("Squeeze Cash")]),e("p",[t._v("Send XCD invoice amount to: SQ03017")]),e("p",[t._v("Please include your invoice number(s)")])],1)],1),e("v-list-item",{attrs:{"three-line":""}},[e("v-list-item-content",[e("v-list-item-title",[t._v("Pay by Paypal:")]),e("p",[t._v("Go to "),e("a",{attrs:{href:"https://www.paypal.me/caribbeanadventures",target:"_blank"}},[t._v("Paypal")])]),e("p",[t._v("Please send USD amount on invoice")]),e("p",[t._v("Please include your invoice number(s)")])],1)],1),e("v-list-item",{attrs:{"three-line":""}},[e("v-list-item-content",[e("v-list-item-title",[t._v("Payswif:")]),e("p",[t._v("Send XCD invoice amount to: 17845303260")]),e("p",[t._v("Please include your invoice number(s)")])],1)],1)],1)],1):t._e(),404==t.billings.status_code?e("h3",{staticClass:"ma-5"},[t._v("No Transaction Found")]):t._e()],1)],1)],1)],1),e("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[e("v-card",{staticClass:"pa-5 mb-0 mb-md-12",attrs:{flat:"",tile:""}},[e("v-card-text",[e("v-card",{attrs:{outlined:""}},[e("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.billings.headers,items:t.billings.transactions,"items-per-page":5}})],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)},n=[],a=e("a34a"),o=e.n(a),r=e("c1df"),l=e.n(r);function c(t,s,e,i,n,a,o){try{var r=t[a](o),l=r.value}catch(c){return void e(c)}r.done?s(l):Promise.resolve(l).then(i,n)}function u(t){return function(){var s=this,e=arguments;return new Promise((function(i,n){var a=t.apply(s,e);function o(t){c(a,i,n,o,r,"next",t)}function r(t){c(a,i,n,o,r,"throw",t)}o(void 0)}))}}var d={data:function(){return{billings:{loaded:!1,showdetails:"",headers:[{text:"Customer NO",align:"start",value:"customer_number"},{text:"Event",value:"event"},{text:"Points",value:"points"},{text:"Staff Name",value:"staff_name"},{text:"Date",value:"created_at"}],transactionMonth:"",transactionYear:(new Date).getFullYear(),transactionYears:[],transactions:[],transaction_details:{earnings:"",spendings:""},due_details:{date:"select a month",amount:"0",status:"0"},invoice_no:"",transaction_fee:""},locale:"en",tab:"tab-0",loading:!0,subscriptionSettings:null,paymentProcessed:!1,paymentProcessedGateway:null,subscriptionCancelled:!1,subscriptionForm:{loading:!1,months:null},stripeHandler:null,selectedMonths:null,selectedRemotePlanId:null}},created:function(){var t=this;this.axios("business/transaction-years").then((function(s){t.billings.transactionYears=s.data.years})),this.locale=this.$auth.check()?this.$auth.user().locale:Intl.DateTimeFormat().resolvedOptions().locale||this.$i18n.locale,this.moment.locale(this.locale.substr(0,2)),this.axios.get("/business/subscription/settings",{params:{locale:this.$i18n.locale}}).then((function(s){if(t.subscriptionSettings=s.data,t.loading=!1,"stripe"==t.subscriptionSettings.gateway){var e={load:function(t,s){var e,i=document.createElement("script");i.setAttribute("src",t),s&&(i.onreadystatechange=i.onload=function(){e||s(),e=!0}),document.getElementsByTagName("head")[0].appendChild(i)}},i=t;e.load("//checkout.stripe.com/checkout.js",(function(){i.stripeHandler=window.StripeCheckout.configure({key:i.subscriptionSettings.key,image:null,locale:"auto",token:function(t){i.subscriptionForm.loading=!0,i.axios.post("/business/stripe/token",{token:t.id,email:t.email,type:t.type,stripe_plan_id:i.selectedRemotePlanId,months:i.selectedMonths}).then((function(t){i.paymentProcessed=!0,i.paymentProcessedGateway="stripe",i.subscriptionForm.loading=!1})).catch((function(t){i.$root.$snackbar("An unknow error has occured. Please refresh this page and try again. Contact us if the error persists."),i.subscriptionForm.loading=!1,console.log(t)}))}})}))}}))},methods:{getTransactions:function(){var t=this;return u(o.a.mark((function s(){var e,i,n,a,r,c,u,d;return o.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,t.axios.get("/business/transaction/".concat(t.billings.transactionMonth,"-").concat(t.billings.transactionYear));case 2:i=s.sent,n=i.data,t.billings.status_code=null!==(e=i.data.status_code)&&void 0!==e?e:200,a=n.transactions,r=n.transaction_details,c=n.due_details,u=n.invoice_no,d=n.transaction_fee,t.billings.transactions=a,t.transaction_fee=d,t.billings.transaction_details.earnings=r.earnings,t.billings.transaction_details.spendings=r.spendings,t.billings.due_details.date=l()(new Date(c.date)).format("DD MMM YYYY"),t.billings.due_details.amount=c.amount,t.billings.due_details.status=c.status,t.billings.invoice_no=u,t.billings.loaded=!0;case 15:case"end":return s.stop()}}),s)})))()},formatNumber:function(t){return new Intl.NumberFormat(this.locale.replace("_","-")).format(t)},formatCurrency:function(t,s){return new Intl.NumberFormat(this.locale.replace("_","-"),{style:"currency",currency:s}).format(t)},formatDate:function(t,s){return t=null===t?"-":"ago"==s?this.moment(t).fromNow():this.moment(t).format(s),t},goToCheckout:function(){var t=this;if(!0===this.$init.config.demo&&"manual"==this.subscriptionSettings.gateway)this.subscriptionForm.loading=!0,this.axios.post("/business/subscription/demo",{locale:this.locale,months:this.subscriptionForm.months}).then((function(s){"success"===s.data.status&&(t.$auth.user(s.data.user),t.paymentProcessed=!0)})).catch((function(s){if("error"===s.response.data.status){t.errorMsg=s.response.data.error;var e=s.response.data.errors||[];for(var i in e)t.$refs["subscriptionForm."+i].applyResult({errors:e[i],valid:!1,failedRules:{}})}})).finally((function(){window.scrollTo(0,0),t.subscriptionForm.loading=!1}));else if("manual"==this.subscriptionSettings.gateway)this.subscriptionForm.loading=!0;else if("stripe"==this.subscriptionSettings.gateway){var s,e,i;1==this.subscriptionForm.months&&(e=this.$t("monthly_subscription"),s=this.subscriptionSettings.plan_id_monthly,i=100*this.subscriptionSettings.premium_price_monthly),12==this.subscriptionForm.months&&(e=this.$t("annual_subscription"),s=this.subscriptionSettings.plan_id_yearly,i=100*this.subscriptionSettings.premium_price_yearly),this.selectedMonths=this.subscriptionForm.months,this.selectedRemotePlanId=s,this.stripeHandler.open({name:e,description:null,currency:this.subscriptionSettings.premium_price_currency,amount:i})}},cancelSubscription:function(){var t=this,s=this;"stripe"==this.subscriptionSettings.gateway&&this.$root.$confirm(this.$t("cancel_subscription"),this.$t("cancel_subscription_confirm")).then((function(e){e&&(s.loading=!0,t.axios.post("/business/stripe/cancel").then((function(t){s.subscriptionCancelled=!0,s.subscriptionSettings.remote_customer_id=null,s.loading=!1})).catch((function(t){console.log(t),s.loading=!1})))}))}},computed:{getMonths:function(){var t=[],s=l.a.months();for(var e in s)t.push({value:"1-".concat(parseInt(e)+1),text:s[e]});return t}},watch:{"billings.transactionMonth":function(t,s){this.billings.transactionMonth=t,""!==t&&this.getTransactions()},"billings.transactionYear":function(t,s){this.billings.transactionYear=t,this.billings.transactionMonth=""}}},m=d,p=(e("cb72"),e("2877")),b=e("6544"),v=e.n(b),h=e("b0af"),g=e("99d9"),_=e("62ad"),f=e("a523"),y=e("8fea"),w=e("ce7e"),C=e("132d"),k=e("b675"),S=e("8860"),P=e("da13"),x=e("5d23"),M=e("0fd9"),V=e("b974"),$=e("71a3"),T=e("c671"),F=e("fe57"),I=e("aac8"),D=e("9a96"),Y=Object(p["a"])(m,i,n,!1,null,null,null);s["default"]=Y.exports;v()(Y,{VCard:h["a"],VCardText:g["c"],VCardTitle:g["d"],VCol:_["a"],VContainer:f["a"],VDataTable:y["a"],VDivider:w["a"],VIcon:C["a"],VInput:k["a"],VList:S["a"],VListItem:P["a"],VListItemContent:x["a"],VListItemTitle:x["c"],VRow:M["a"],VSelect:V["a"],VTab:$["a"],VTabItem:T["a"],VTabs:F["a"],VTabsItems:I["a"],VTabsSlider:D["a"]})},cb72:function(t,s,e){"use strict";var i=e("823f"),n=e.n(i);n.a}}]);